# Rin â€” åŸºäº Cloudflare çš„ç°ä»£åšå®¢ç³»ç»Ÿ

åŸºäº [Rin](https://github.com/openRin/Rin) æ¶æ„é‡å†™ï¼Œä½¿ç”¨ **Cloudflare Workers (Hono)** ä½œä¸ºåç«¯ APIï¼Œ**Vue 3** ä½œä¸ºå‰ç«¯ SPAã€‚

## é¡¹ç›®ç»“æ„

```
â”œâ”€â”€ frontend/          # Vue 3 å‰ç«¯ (Vite)
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ views/     # é¡µé¢ç»„ä»¶ (é¦–é¡µã€æ–‡ç« ã€ç™»å½•ã€æ³¨å†Œã€åå°)
â”‚   â”‚   â”œâ”€â”€ composables/ # ç»„åˆå¼å‡½æ•° (useAuth)
â”‚   â”‚   â”œâ”€â”€ router/    # è·¯ç”±é…ç½®
â”‚   â”‚   â””â”€â”€ styles/    # è®¾è®¡ç³»ç»Ÿ (æš—é»‘æ¨¡å¼ã€ç»ç’ƒæ‹Ÿæ€)
â”‚   â””â”€â”€ dist/          # ç¼–è¯‘äº§ç‰© (éƒ¨ç½²æ—¶è‡ªåŠ¨ç”Ÿæˆ)
â”œâ”€â”€ src/               # Cloudflare Worker API (Hono)
â”‚   â”œâ”€â”€ index.js       # å…¥å£ï¼šAPI è·¯ç”± + é™æ€èµ„æºè½¬å‘
â”‚   â”œâ”€â”€ db.js          # D1 æ•°æ®åº“è¾…åŠ©æ¨¡å—
â”‚   â”œâ”€â”€ email.js       # é‚®ä»¶å‘é€å·¥å…· (Resend API)
â”‚   â””â”€â”€ routes/
â”‚       â”œâ”€â”€ auth.js    # è®¤è¯ API (ç™»å½•/æ³¨å†Œ/éªŒè¯ç /ç”¨æˆ·ç®¡ç†)
â”‚       â””â”€â”€ posts.js   # æ–‡ç«  API (CRUD)
â””â”€â”€ wrangler.toml      # Cloudflare é…ç½® (D1, KV, Resend)
```

## æŠ€æœ¯æ ˆ

| å±‚çº§ | æŠ€æœ¯ |
|------|------|
| å‰ç«¯ | Vue 3 + Vite + Vue Router |
| åç«¯ | Hono (è¾¹ç¼˜è½»é‡æ¡†æ¶) |
| æ•°æ®åº“ | Cloudflare D1 (SQLite) |
| ç¼“å­˜/ä¼šè¯ | Cloudflare KV (Token + éªŒè¯ç ) |
| é‚®ä»¶æœåŠ¡ | Resend API |
| å¯¹è±¡å­˜å‚¨ | Cloudflare R2 (å›¾ç‰‡) |
| é™æ€èµ„æº | Workers Static Assets |

## å¿«é€Ÿå¼€å§‹

### å‰ç½®æ¡ä»¶

- Node.js 18+
- Wrangler CLI (`npm install -g wrangler`)
- Cloudflare è´¦å· (å·²ç»‘å®š D1 å’Œ KV)
- Resend è´¦å· (ç”¨äºå‘é€éªŒè¯ç é‚®ä»¶)

### ç¯å¢ƒé…ç½®

```bash
# 1. åˆ›å»º R2 å­˜å‚¨æ¡¶ï¼ˆå›¾ç‰‡ä¸Šä¼ ï¼‰
npx wrangler r2 bucket create suyuan-images

# 2. é…ç½® Resend API Keyï¼ˆåŠ å¯†å­˜å‚¨ï¼Œä¸å†™å…¥ä»£ç ï¼‰
npx wrangler versions secret put RESEND_API_KEY
# éƒ¨ç½²æ–°ç‰ˆæœ¬
npx wrangler versions deploy
```

å‘ä¿¡åœ°å€å·²åœ¨ `wrangler.toml` çš„ `[vars]` ä¸­é…ç½®ï¼š

```toml
RESEND_FROM = "noreply@yourdomain.com"
```

### æœ¬åœ°å¼€å‘

```bash
# 1. å®‰è£…ä¾èµ–
npm install
cd frontend && npm install && cd ..

# 2. å¯åŠ¨åç«¯ (ç«¯å£ 8787)
npm run dev

# 3. å¯åŠ¨å‰ç«¯ (ç«¯å£ 5173ï¼Œå¦å¼€ç»ˆç«¯)
cd frontend && npm run dev
```

å‰ç«¯å·²é…ç½®ä»£ç†ï¼Œ`/api` è¯·æ±‚ä¼šè‡ªåŠ¨è½¬å‘åˆ°åç«¯ã€‚

### éƒ¨ç½²åˆ° Cloudflare

```bash
# ä¸€é”®ç¼–è¯‘å‰ç«¯ + éƒ¨ç½² Worker
npm run deploy
```

## åŠŸèƒ½ç‰¹æ€§

### ç”¨æˆ·è®¤è¯
- âœ… é‚®ç®±éªŒè¯ç æ³¨å†Œï¼ˆåˆ†æ­¥ï¼šå‘é€éªŒè¯ç  â†’ è¾“å…¥éªŒè¯ç +å¯†ç ï¼‰
- âœ… å¯†ç ç™»å½•ï¼ˆç”¨æˆ·å/é‚®ç®± + å¯†ç ï¼‰
- âœ… éªŒè¯ç ç™»å½•ï¼ˆé‚®ç®± + éªŒè¯ç ï¼ŒTab åˆ‡æ¢ï¼‰
- âœ… å¯†ç å¤æ‚åº¦æ ¡éªŒï¼ˆâ‰¥8ä½ + å¤§å°å†™å­—æ¯ + æ•°å­—ï¼‰
- âœ… éªŒè¯ç é˜²åˆ·ï¼ˆ60 ç§’å†·å´ + 5 åˆ†é’Ÿè¿‡æœŸ + ä¸€æ¬¡æ€§ä½¿ç”¨ï¼‰
- âœ… Token ä¼šè¯ç®¡ç†ï¼ˆKVï¼Œ24 å°æ—¶è¿‡æœŸï¼‰

### ç”¨æˆ·ç®¡ç†
- âœ… ç”¨æˆ·å/é‚®ç®±/æ‰‹æœºå·å”¯ä¸€æ€§æ ¡éªŒ
- âœ… ä¸ªäººä¿¡æ¯ç¼–è¾‘ï¼ˆä¸ªäººä¸­å¿ƒï¼‰
- âœ… ç®¡ç†å‘˜æ·»åŠ ç”¨æˆ·
- âœ… ç®¡ç†å‘˜ç¼–è¾‘ç”¨æˆ·ï¼ˆç”¨æˆ·åã€é‚®ç®±ã€æ‰‹æœºå·ã€è§’è‰²ï¼‰
- âœ… ç®¡ç†å‘˜åˆ é™¤ç”¨æˆ·ï¼ˆä¸å¯åˆ é™¤è‡ªèº«ï¼‰
- âœ… ä¿®æ”¹å¯†ç 

### å†…å®¹ç®¡ç†
- âœ… æ–‡ç«  CRUDï¼ˆåˆ›å»º/åˆ—è¡¨/è¯¦æƒ…/åˆ é™¤ï¼‰
- âœ… æ ‡ç­¾ç³»ç»Ÿ
- âœ… ç®¡ç†åå°
- âœ… å›¾ç‰‡ä¸Šä¼  (R2)ï¼šæ”¯æŒç‚¹å‡»ä¸Šä¼ ã€æ‹–æ‹½ä¸Šä¼ ã€ç²˜è´´ä¸Šä¼ 

### UI/UX
- âœ… ç»ç’ƒæ‹Ÿæ€æš—é»‘ä¸»é¢˜
- âœ… å“åº”å¼è®¾è®¡ï¼ˆæ¡Œé¢ç«¯è¡¨æ ¼ + ç§»åŠ¨ç«¯å¡ç‰‡ï¼‰
- âœ… SPA è·¯ç”±ï¼ˆå‰ç«¯è·¯ç”±ä¸ä¼š 404ï¼‰

### è§„åˆ’ä¸­
- ğŸ”² è¯„è®ºç³»ç»Ÿ
- ğŸ”² GitHub OAuth ç™»å½•
- ğŸ”² å‹æƒ…é“¾æ¥

## API æ¥å£

| æ–¹æ³• | è·¯å¾„ | è¯´æ˜ |
|------|------|------|
| POST | `/api/auth/send-code` | å‘é€é‚®ç®±éªŒè¯ç  |
| POST | `/api/auth/register` | æ³¨å†Œï¼ˆéœ€éªŒè¯ç ï¼‰ |
| POST | `/api/auth/login` | å¯†ç ç™»å½• |
| POST | `/api/auth/login-code` | éªŒè¯ç ç™»å½• |
| GET | `/api/auth/me` | è·å–å½“å‰ç”¨æˆ·ä¿¡æ¯ |
| PUT | `/api/auth/me` | æ›´æ–°ä¸ªäººä¿¡æ¯ |
| POST | `/api/auth/password` | ä¿®æ”¹å¯†ç  |
| GET | `/api/auth/users` | ç”¨æˆ·åˆ—è¡¨ï¼ˆç®¡ç†å‘˜ï¼‰ |
| POST | `/api/auth/users/add` | æ·»åŠ ç”¨æˆ·ï¼ˆç®¡ç†å‘˜ï¼‰ |
| PUT | `/api/auth/users/:id` | ç¼–è¾‘ç”¨æˆ·ï¼ˆç®¡ç†å‘˜ï¼‰ |
| DELETE | `/api/auth/users/:id` | åˆ é™¤ç”¨æˆ·ï¼ˆç®¡ç†å‘˜ï¼‰ |
| POST | `/api/upload` | ä¸Šä¼ å›¾ç‰‡ï¼ˆéœ€ç™»å½•ï¼‰ |
| GET | `/api/upload/:year/:month/:name` | è®¿é—®å›¾ç‰‡ï¼ˆå…¬å¼€ï¼‰ |
| GET | `/api/upload` | å›¾ç‰‡åˆ—è¡¨ï¼ˆéœ€ç™»å½•ï¼‰ |
| DELETE | `/api/upload/:year/:month/:name` | åˆ é™¤å›¾ç‰‡ï¼ˆç®¡ç†å‘˜ï¼‰ |

## è®¸å¯è¯

MIT
